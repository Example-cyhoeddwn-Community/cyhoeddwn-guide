<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Architecture - cyhoeddwn help</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.7.1 --> <title>Architecture | cyhoeddwn help</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Architecture" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Architecture" /> <meta property="og:description" content="Architecture" /> <link rel="canonical" href="/docs/deployment/architecture/" /> <meta property="og:url" content="/docs/deployment/architecture/" /> <meta property="og:site_name" content="cyhoeddwn help" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-09-09T13:04:33+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Architecture" /> <script type="application/ld+json"> {"description":"Architecture","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"/logo.png"}},"url":"/docs/deployment/architecture/","@type":"BlogPosting","headline":"Architecture","dateModified":"2021-09-09T13:04:33+00:00","datePublished":"2021-09-09T13:04:33+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"/docs/deployment/architecture/"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="/" class="site-title lh-tight"> <div class="site-logo"></div> </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/docs/about/index/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/admin/index/" class="nav-list-link">Administration</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/admin/make_admin/" class="nav-list-link">Grant/revoke admin privileges</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/index/" class="nav-list-link">Deploying cyhoeddwn</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/stakeholder_engagement/" class="nav-list-link">Stakeholder engagement</a><ul class="nav-list"></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/cms_deployment/" class="nav-list-link">CMS deployment</a><ul class="nav-list"><li class="nav-list-item active"> <a href="/docs/deployment/architecture/" class="nav-list-link active">Architecture</a> </li><li class="nav-list-item "> <a href="/docs/deployment/domains/" class="nav-list-link">Domains</a> </li></ul></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/deployment/display_deployment/" class="nav-list-link">Display deployment</a><ul class="nav-list"><li class="nav-list-item "> <a href="/docs/deployment/picking_raspi/" class="nav-list-link">Picking Raspberries</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/getting_started/index/" class="nav-list-link">Getting Started</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/getting_started/new_user/" class="nav-list-link">Signing up</a></li><li class="nav-list-item "><a href="/docs/getting_started/sign_in/" class="nav-list-link">Logging in</a></li><li class="nav-list-item "><a href="/docs/getting_started/sign_out/" class="nav-list-link">Logging out</a></li><li class="nav-list-item "><a href="/docs/getting_started/password_reset/" class="nav-list-link">Forgotten password</a></li><li class="nav-list-item "><a href="/docs/getting_started/new_post/" class="nav-list-link">Creating a post</a></li><li class="nav-list-item "><a href="/docs/getting_started/edit_post/" class="nav-list-link">Editing a post</a></li><li class="nav-list-item "><a href="/docs/getting_started/moderation/" class="nav-list-link">Post Moderation</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/guide/index/" class="nav-list-link">Maintaining the guide</a><ul class="nav-list "><li class="nav-list-item "><a href="/docs/guide/org_settings/" class="nav-list-link">GitHub organization settings</a></li><li class="nav-list-item "><a href="/docs/guide/fork/" class="nav-list-link">Forking cyhoeddwn-guide</a></li><li class="nav-list-item "><a href="/docs/guide/example/" class="nav-list-link">Example workflow</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="/docs/guidelines/index/" class="nav-list-link">Community guidelines</a><ul class="nav-list "></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search cyhoeddwn help" aria-label="Search cyhoeddwn help" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/docs/deployment/index/">Deploying cyhoeddwn</a></li> <li class="breadcrumb-nav-list-item"><a href="/docs/deployment/cms_deployment/">CMS deployment</a></li> <li class="breadcrumb-nav-list-item"><span>Architecture</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 id="architecture"> <a href="#architecture" class="anchor-heading" aria-labelledby="architecture"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Architecture </h1> <p><img src="/assets/img/deployment/cyhoeddwn_architecture.png" alt="" /></p> <p>cyhoeddwn is built around the <a href="https://rubyonrails.org/">Rails</a> web app framework for Ruby (an object-oriented programming language). A UML diagram for an example cyhoeddwn deployment is provided below. Users and admins interact with cyhoeddwn through a web application, which is accessed through a phone, tablet, or computer. cyhoeddwn sits either behind a dedicated ‘Rack-compatible’ server (like Puma) or behind some middleware (like Passenger) which will talk to an HTTP server (like Apache or NGINX) on cyhoeddwn’s behalf.</p> <p>The Rails framework is MVC in nature, that is: ‘model, view, controller’. A model used in cyhoeddwn, for example, is ‘Post’. A post is a piece of content that has been shared. The attributes of a post (‘may have a photo attached’, ‘must be less than 140 characters’, ‘belongs to a user’, ‘has one or many reviews’ etc.) are defined in a model. A model verifies the attributes of an instance of a post. Posts can be instantiated (constructed as an instance of a Post class, with associated methods) through talking to a PostgreSQL database through Active Record. This Rails plug-in <a href="https://en.wikipedia.org/wiki/Serialization">serialises</a> instances of Post through the Active Record <a href="https://en.wikipedia.org/wiki/Object%E2%80%93relational_mapping">object-relational mapper</a>.</p> <p>Views are created as needed through Action View. A view is the HTML/CSS/JS that is visible to the user. Elements of the view can be added programmatically through Action View. For example, posts on a user’s page are rendered using Action View, by asking for a user’s posts from Active Model, and are then rendered by inserting parts of the post from the record into a template.</p> <p>The controller in Rails is Action Controller. The controller effectively links the model and view together. An HTTP request is provided to some end-point, which triggers a set of actions. For example, following our example, an HTTP GET request to <code class="language-plaintext highlighter-rouge">/users/1</code> would:</p> <ul> <li>be checked against <code class="language-plaintext highlighter-rouge">config/routes.rb</code> to ensure there is an associated route, there is so,</li> <li>the <code class="language-plaintext highlighter-rouge">show</code> method on the <code class="language-plaintext highlighter-rouge">users</code> controller would be run,</li> <li>the <code class="language-plaintext highlighter-rouge">before_action</code> method <code class="language-plaintext highlighter-rouge">logged_in_user</code> is run, redirecting if not logged in,</li> <li>the instance variables <code class="language-plaintext highlighter-rouge">@user</code> and <code class="language-plaintext highlighter-rouge">@posts</code> are generated from the user’s record,</li> <li>instance variables are passed to the <code class="language-plaintext highlighter-rouge">show.html.erb</code> template which passes necessary instance variables to other “partial” templates, thereby rendering the user’s page.</li> </ul> <p>Rendered pages (the frontend) generated by Rails are passed through middleware back to the web server, where they are delivered back through the internet either to a user’s device or a display.</p> <p>When performing a task that is likely to lock the main app’s process thread, Active Job takes over. The Active Job backend (in this case <a href="https://github.com/resque/resque">Resque</a>) creates a description of a task that is to be run, and stores it in a queue (as an entry in a highly available, performant Redis key-value pair database). When a worker (a process which can run Ruby tasks) is available to run, jobs can be taken from the queue and performed. Jobs are stored in separate queues based on their importance, all highly important jobs will be performed first, then descending based on order of importance.</p> <p>Due to the <a href="https://devcenter.heroku.com/articles/active-storage-on-heroku">“ephemeral” nature</a> of storage space provided by some PaaS/IaaS providers, cyhoeddwn must make use of a more permanent storage place for uploaded media. It is incredibly inefficient to store binary “blobs” (like images and formatted documents) in relational databases, so Rails makes use of a plug-in called Active Storage, where files can be stored and manipulated easily. In this case, cyhoeddwn connects to an <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Welcome.html">AWS S3</a> or S3-compatible bucket (i.e. <a href="https://www.digitalocean.com/products/spaces/">DigitalOcean Spaces</a>) to store photos from posts. Entries for photos in the relational database point towards where photos are stored in a bucket.</p> <hr> <footer> <p class="text-small text-grey-dk-100 mb-0"><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br>cyhoeddwn, software for managing content for connected rural pervasive displays.<br>Made with ❤️ by <a href="https://dev.becquerel.me/">Genevieve Clifford</a></p> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0 mr-2"> Page last modified: <span class="d-inline-block">Jul 3 2021 at 04:38 PM</span>. </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
